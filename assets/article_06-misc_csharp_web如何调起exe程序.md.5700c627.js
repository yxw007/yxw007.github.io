import{_ as s,o as a,c as n,B as l}from"./app.b0a23cbd.js";const A=JSON.parse('{"title":"web如何调起exe程序","description":"","frontmatter":{"title":"web如何调起exe程序","author":"Potter","date":"2023-08-02T16:28:32.000Z","tags":["C#"],"categories":["Web"]},"headers":[{"level":2,"title":"H5 配置","slug":"h5-配置","link":"#h5-配置","children":[]},{"level":2,"title":"exe程序需要往注册表中注册URL Protocol 启动命令","slug":"exe程序需要往注册表中注册url-protocol-启动命令","link":"#exe程序需要往注册表中注册url-protocol-启动命令","children":[]},{"level":2,"title":"参考文献","slug":"参考文献","link":"#参考文献","children":[]}],"relativePath":"article/06-misc/csharp/web如何调起exe程序.md","lastUpdated":1713147964000}'),o={name:"article/06-misc/csharp/web如何调起exe程序.md"},p=l(`<h1 id="web-如何调起exe程序" tabindex="-1">web：如何调起exe程序 <a class="header-anchor" href="#web-如何调起exe程序" aria-hidden="true">#</a></h1><h2 id="h5-配置" tabindex="-1">H5 配置 <a class="header-anchor" href="#h5-配置" aria-hidden="true">#</a></h2><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">WebStartupExe:startup?a=b&amp;c=2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">Click to trigger</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><ul><li>WebStartupExe：应用程序名</li><li>startup：启动命令</li><li>a=b&amp;c=2：就是传给exe程序的参数</li></ul><h2 id="exe程序需要往注册表中注册url-protocol-启动命令" tabindex="-1">exe程序需要往注册表中注册URL Protocol 启动命令 <a class="header-anchor" href="#exe程序需要往注册表中注册url-protocol-启动命令" aria-hidden="true">#</a></h2><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">using</span><span style="color:#BABED8;"> Microsoft</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Win32</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">using</span><span style="color:#BABED8;"> System</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">using</span><span style="color:#BABED8;"> System</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">IO</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">using</span><span style="color:#BABED8;"> System</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Linq</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">namespace</span><span style="color:#BABED8;"> WMConsole</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Program</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#C792EA;">static</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">void</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">Main</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">string</span><span style="color:#89DDFF;">[]</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">args</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Listening..</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">args:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">---------------------------</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;font-style:italic;">foreach</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">var</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">arg</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#BABED8;"> args</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">                Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">arg</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">---------------------------</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#FFCB6B;">var</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">parameters</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">string</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Join</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> args</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">parameters:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;"> parameters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Substring</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">parameters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IndexOf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            </span><span style="color:#676E95;font-style:italic;">//Gets the current location where the file is downloaded</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#FFCB6B;">var</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">loc</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> System</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Reflection</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Assembly</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetExecutingAssembly</span><span style="color:#89DDFF;">().</span><span style="color:#BABED8;">Location</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(!</span><span style="color:#BABED8;">Directory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Exists</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">@&quot;</span><span style="color:#C3E88D;">E:\\Console\\</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">                System</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">IO</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Directory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateDirectory</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">@&quot;</span><span style="color:#C3E88D;">E:\\Console\\</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">            </span><span style="color:#676E95;font-style:italic;">//Creates the Downloaded file in the specified folder</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(!</span><span style="color:#BABED8;">File</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Exists</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">@&quot;</span><span style="color:#C3E88D;">E:\\Console\\</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;"> loc</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">\\\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Last</span><span style="color:#89DDFF;">()))</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">                File</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Move</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">loc</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">@&quot;</span><span style="color:#C3E88D;">E:\\Console\\</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;"> loc</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Split</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">\\\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">Last</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#FFCB6B;">var</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">KeyTest</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> Registry</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">CurrentUser</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">OpenSubKey</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Software</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">OpenSubKey</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Classes</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#FFCB6B;">RegistryKey</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">key</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> KeyTest</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateSubKey</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">WebStartupExe</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            key</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetValue</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">URL Protocol</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">startup</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            key</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateSubKey</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">@&quot;</span><span style="color:#C3E88D;">shell\\open\\command</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">SetValue</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">\\&quot;</span><span style="color:#C3E88D;">E:</span><span style="color:#BABED8;">\\\\</span><span style="color:#C3E88D;">Console</span><span style="color:#BABED8;">\\\\</span><span style="color:#C3E88D;">WebStartupExe.exe</span><span style="color:#BABED8;">\\&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#BABED8;">\\&quot;</span><span style="color:#C3E88D;">%1</span><span style="color:#BABED8;">\\&quot;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">启动成功</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">            Console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ReadKey</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="参考文献" tabindex="-1">参考文献 <a class="header-anchor" href="#参考文献" aria-hidden="true">#</a></h2><ul><li><a href="https://www.codeproject.com/Articles/1168356/Run-an-EXE-from-Web-Application" target="_blank" rel="noreferrer">https://www.codeproject.com/Articles/1168356/Run-an-EXE-from-Web-Application</a></li><li><a href="https://stackoverflow.com/questions/3057576/how-to-launch-an-application-from-a-browser" target="_blank" rel="noreferrer">https://stackoverflow.com/questions/3057576/how-to-launch-an-application-from-a-browser</a></li><li><a href="https://github.dev/vireshshah/custom-protocol-check" target="_blank" rel="noreferrer">https://github.dev/vireshshah/custom-protocol-check</a></li><li><a href="https://blog.csdn.net/qq_30599613/article/details/93193809" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_30599613/article/details/93193809</a></li></ul>`,8),e=[p];function t(r,c,D,F,y,B){return a(),n("div",null,e)}const E=s(o,[["render",t]]);export{A as __pageData,E as default};
